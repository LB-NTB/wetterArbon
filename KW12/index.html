<!DOCTYPE html>
<html lang="en">
    <head>
        <meta charset="utf-8">
        <meta http-equiv="X-UA-Compatible" content="IE=edge">
        <meta name="viewport" content="width=device-width, initial-scale=1.0">
        
        
        
        <link rel="shortcut icon" href="../img/favicon.ico">
        <title>KW12 - Wetter Arbon</title>
        <link href="../css/bootstrap-custom.min.css" rel="stylesheet">
        <link href="../css/font-awesome-4.5.0.css" rel="stylesheet">
        <link href="../css/base.css" rel="stylesheet">
        <link rel="stylesheet" href="../css/highlight.css">
        <!-- HTML5 shim and Respond.js IE8 support of HTML5 elements and media queries -->
        <!--[if lt IE 9]>
            <script src="https://oss.maxcdn.com/libs/html5shiv/3.7.0/html5shiv.js"></script>
            <script src="https://oss.maxcdn.com/libs/respond.js/1.3.0/respond.min.js"></script>
        <![endif]-->

        <script src="../js/jquery-1.10.2.min.js"></script>
        <script src="../js/bootstrap-3.0.3.min.js"></script>
        <script src="../js/highlight.pack.js"></script> 
    </head>

    <body>

        <div class="navbar navbar-default navbar-fixed-top" role="navigation">
    <div class="container">

        <!-- Collapsed navigation -->
        <div class="navbar-header">
            <!-- Expander button -->
            <button type="button" class="navbar-toggle" data-toggle="collapse" data-target=".navbar-collapse">
                <span class="sr-only">Toggle navigation</span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
            </button>
            <a class="navbar-brand" href="..">Wetter Arbon</a>
        </div>

        <!-- Expanded navigation -->
        <div class="navbar-collapse collapse">
                <!-- Main navigation -->
                <ul class="nav navbar-nav">
                    <li >
                        <a href="..">Home</a>
                    </li>
                    <li class="dropdown">
                        <a href="#" class="dropdown-toggle" data-toggle="dropdown">Meetings <b class="caret"></b></a>
                        <ul class="dropdown-menu">
                            
<li >
    <a href="../idee/">Themenvorschlag BA</a>
</li>
                            
<li >
    <a href="../kickoff/">Kick off Meeting</a>
</li>
                            
<li >
    <a href="../meetings/">Meetings</a>
</li>
                        </ul>
                    </li>
                    <li class="dropdown active">
                        <a href="#" class="dropdown-toggle" data-toggle="dropdown">Reports BA <b class="caret"></b></a>
                        <ul class="dropdown-menu">
                            
<li >
    <a href="../KW08/">KW08</a>
</li>
                            
<li >
    <a href="../KW09/">KW09</a>
</li>
                            
<li >
    <a href="../KW10/">KW10</a>
</li>
                            
<li >
    <a href="../KW11/">KW11</a>
</li>
                            
<li class="active">
    <a href="./">KW12</a>
</li>
                            
<li >
    <a href="../KW13/">KW13</a>
</li>
                            
<li >
    <a href="../KW14/">KW14</a>
</li>
                            
<li >
    <a href="../KW15/">KW15</a>
</li>
                            
<li >
    <a href="../KW16/">KW16</a>
</li>
                            
<li >
    <a href="../KW17/">KW17</a>
</li>
                            
<li >
    <a href="../KW18/">KW18</a>
</li>
                            
<li >
    <a href="../KW19/">KW19</a>
</li>
                            
<li >
    <a href="../KW20/">KW20</a>
</li>
                            
<li >
    <a href="../KW21/">KW21</a>
</li>
                            
<li >
    <a href="../KW22/">KW22</a>
</li>
                            
<li >
    <a href="../KW23/">KW23</a>
</li>
                            
<li >
    <a href="../KW24/">KW24</a>
</li>
                            
<li >
    <a href="../KW25/">KW25</a>
</li>
                            
<li >
    <a href="../KW26/">KW26</a>
</li>
                            
<li >
    <a href="../KW27/">KW27</a>
</li>
                        </ul>
                    </li>
                    <li class="dropdown">
                        <a href="#" class="dropdown-toggle" data-toggle="dropdown">Reports FM <b class="caret"></b></a>
                        <ul class="dropdown-menu">
                            
<li >
    <a href="../KW44/">KW44</a>
</li>
                            
<li >
    <a href="../KW45/">KW45</a>
</li>
                            
<li >
    <a href="../KW46/">KW46</a>
</li>
                            
<li >
    <a href="../KW47/">KW47</a>
</li>
                            
<li >
    <a href="../KW48/">KW48</a>
</li>
                            
<li >
    <a href="../KW49/">KW49</a>
</li>
                            
<li >
    <a href="../KW50/">KW50</a>
</li>
                            
<li >
    <a href="../KW51/">KW51</a>
</li>
                        </ul>
                    </li>
                    <li >
                        <a href="../about/">About</a>
                    </li>
                </ul>

            <ul class="nav navbar-nav navbar-right">
                <li>
                    <a href="#" data-toggle="modal" data-target="#mkdocs_search_modal">
                        <i class="fa fa-search"></i> Search
                    </a>
                </li>
                    <li >
                        <a rel="next" href="../KW11/">
                            <i class="fa fa-arrow-left"></i> Previous
                        </a>
                    </li>
                    <li >
                        <a rel="prev" href="../KW13/">
                            Next <i class="fa fa-arrow-right"></i>
                        </a>
                    </li>
            </ul>
        </div>
    </div>
</div>

        <div class="container">
                <div class="col-md-3"><div class="bs-sidebar hidden-print affix well" role="complementary">
    <ul class="nav bs-sidenav">
        <li class="main active"><a href="#wochenreport-kw-12">Wochenreport KW 12</a></li>
            <li><a href="#ziel-dieser-woche">Ziel dieser Woche</a></li>
            <li><a href="#resultat-erkenntnisse">Resultat / Erkenntnisse</a></li>
            <li><a href="#probleme-herausforderungen">Probleme / Herausforderungen</a></li>
            <li><a href="#journal-zeitaufwand">Journal / Zeitaufwand</a></li>
    </ul>
</div></div>
                <div class="col-md-9" role="main">

<h1 id="wochenreport-kw-12">Wochenreport KW 12</h1>
<h2 id="ziel-dieser-woche">Ziel dieser Woche</h2>
<ul>
<li>Datenbankarchivierung prüfen</li>
<li>Datenbankkonzept erstellen</li>
<li>Gegenüberstellung Textfile vs. DB</li>
<li>Ausbau des Pegelsensors</li>
<li>Konzept zu Mobile First erstellen</li>
</ul>
<h2 id="resultat-erkenntnisse">Resultat / Erkenntnisse</h2>
<h3 id="datenbankstruktur-ausdunnung-datenbankkonzept">Datenbankstruktur ausdünnung / Datenbankkonzept</h3>
<p>Es wurde eine Konzept erstellt, welches die jetzige Tabelle wx data unverändert lässt. Des Weiteren werden die bestehenden Tabellen tblWellen und tblWind gelöscht. Die Daten welche in der Tabelle sind werden in die neue Tabelle tblExtSensors übernommen. Diese Tabelle wird alle Externe Sensoren beinhalten und wäre auch weiter ausbaufähig im Falle neuer Sensoren. Die beiden Tabellen wx data und tblExtSensors werden über eine Datums und Zeit Tabelle miteinander Verknpft, indem das Datum und die Zeit der Fremdschlüssel ist und eine Tabelle tblData aufgebaut wird. Mit diesem Vorgehen kann die Datenbank weiter ausgebaut werden ohne das die funktionsfähige Tabelle wx data verändert wird.</p>
<p><img alt="Screenshot" src="../img/DatenbankNeu.jpg" />
<em>Abb.: Neues Datenbankschema</em></p>
<p>Um die historischen Daten zu erstellen wird eine einzelne Tabelle erstellt, welche die minuten Daten der beiden Tabellen wx data und tblExtSensors pro Stunde mittelt in die tblHistorical schreibt.<br />
Um die Sicherheit der Datenbank zu erhöhen werden auf dem Server Abfragen ausgeführt und diese Resultate anschliessend in ein Textfile geschrieben. So kann einerseits verhindert werden das jemand auf die Datenbank zugreift, andererseits wird so die Perfomance beim auslesen für die Grafiken erhöht.</p>
<h3 id="textfile-vs-db">Textfile vs DB</h3>
<p>Um die performance Unterschiede zwischen dem Auslesen der Textfiles sowie der Datenbank zu vergleichen wurde ein Testfile geschreieben welche den Zeitunterschied misst.</p>
<pre><code>&lt;?php

     echo(&quot;&lt;h3&gt;Test without condition!&lt;/h3&gt;&quot;);
     echo &quot;Reading File ... &lt;BR /&gt;&quot;;

     $start = explode(&quot; &quot;,microtime());
     $beginfile = $start[1]+$start[0];

     $h = fopen(&quot;WDL/clientraw.txt&quot;,&quot;r&quot;);
     if (!$h) return;
         $msg=&quot;&quot;;

     while (!feof($h))
         fgets($h);

     $start = explode(&quot; &quot;,microtime());
     $endfile = $start[1]+$start[0];

     echo &quot;Reading Database ... &lt;BR /&gt;&quot;;

     $start = explode(&quot; &quot;,microtime());
     $begindb = $start[1]+$start[0];

     $db=mysql_connect(&quot;&quot;);
     mysql_select_db(&quot;igwetter_wettertest&quot;);
     $r = mysql_query(&quot;SELECT * FROM wx_data WHERE `date`= '2018-03-13' AND time = '19:21:00'&quot;);

     while($f = mysql_fetch_array($r));

     $start = explode(&quot; &quot;,microtime());
     $enddb = $start[1]+$start[0];

     echo &quot;Result of benchmark&quot;;

     $resultfile = $endfile - $beginfile;
     $resultdb = $enddb - $begindb;

     echo &quot;&lt;BR /&gt;Flat File time span to do the operation ==&gt; $resultfile .&quot;;
     echo &quot;&lt;BR /&gt;Database time span to do the operation ==&gt; $resultdb .&lt;br/&gt;&quot;;

     if($resultdb&gt;$resultfile)
     {
         $diff=$resultdb - $resultfile;
         printf(&quot;File operation was faster by %f&quot;,$diff);
     }
     else
     {
         $diff=$resultfile-$resultdb;
         printf(&quot;Database operation was faster by %f&quot;,$diff);
     }

     mysql_close($db);
     fclose($h);


     //NEW TEST
     echo(&quot;&lt;h3&gt;Test with condition temperature&lt;/h3&gt;&quot;);
     echo &quot;Reading File ... &lt;BR /&gt;&quot;;
     $start = explode(&quot; &quot;,microtime());
     $beginfile = $start[1]+$start[0];

     $h = fopen(&quot;WDL/clientraw.txt&quot;,&quot;r&quot;);

     while (!feof($h))
     {
         $line=fgets($h);
         $temperature = $line[17].$line[18].$line[19].$line[20];
         if(eregi(&quot;^a&quot;,$line));
     }

     $start = explode(&quot; &quot;,microtime());
     $endfile = $start[1]+$start[0];

     echo &quot;Reading Database ... &lt;BR /&gt;&quot;;

     $start = explode(&quot; &quot;,microtime());
     $begindb = $start[1]+$start[0];

     $db=mysql_connect(&quot;&quot;);
     mysql_select_db(&quot;igwetter_wettertest&quot;);
     $r = mysql_query(&quot;SELECT `temperature`, MAX(time) lastTime FROM wx_data WHERE `date` = CURRENT_DATE &quot;);

     while($f = mysql_fetch_array($r));

     $start = explode(&quot; &quot;,microtime());
     $enddb = $start[1]+$start[0];

     echo &quot;Result of benchmark&quot;;

     $resultfile = $endfile - $beginfile;
     $resultdb = $enddb - $begindb;

     echo &quot;&lt;BR /&gt;Flat File time span to do the operation ==&gt; $resultfile .&quot;;
     echo &quot;&lt;BR /&gt;Database time span to do the operation ==&gt; $resultdb .&lt;br/&gt;&quot;;

     if($resultdb&gt;$resultfile)
     {
         $diff=$resultdb - $resultfile;
         printf(&quot;File operation was faster by %f&quot;,$diff);
     }
     else
     {
         $diff=$resultfile-$resultdb;
         printf(&quot;Database operation was faster by %f&quot;,$diff);
     }


     ?&gt;
</code></pre>

<p>Beim Test stellte sich heraus das der Unterschied 7 bzw 1 Sekunde beträgt. Beim ersten Test wird die gesamte Datenbank ausgelesen, beim zweiten wird nur eine Abfrage auf die Temperatur gemacht. Das Testresultat kann unter folgendem Link begutachtet werden:</p>
<p><a href="../www.wetter-arbon.ch/benchmark.php">Benchmark.php</a></p>
<h3 id="ausbau-des-pegelsensors">Ausbau des Pegelsensors</h3>
<p>Am Samstagmorgen konnte der Pegelsensor ausgebaut werden. Als nächstes soll er mit Wasser und anschliessend im Ultraschallbad gereinigt werden. Falls sich die Kalkreste nicht lösen lassen kommt noch eine chemische Reinigung hinzu. Soblad der Sensor wieder einigermassen sauber ist, führen wir eine Funktionskontrolle durch. Diese wird zeigen, ob wir mit diesem Sensor weiterarbeiten können, oder ob ein neuer bestellt werden muss.</p>
<p><img alt="Screenshot" src="../img/pegelsensor.png" />
<em>Abb.: Ausgebauter Pegelsensor</em></p>
<h3 id="konzept-zu-mobile-first">Konzept zu Mobile First</h3>
<p>Das Mobile First Prinzip besteht darin, dass zuerst die mobile Webseite designt wird. Da diese nur einen Bruchteil der Information anzeigen kann wie eine Desktop-Seite, ist man gezwungen festzulegen welches die wichtigsten Informationen auf der Seite sind. Für diese Arbeit ist es wichtig zu verstehen wer die Zielgruppe der Webseite ist und was die Bedürfnisse und Erwartungen der Zielgruppe ist. Wir haben deshalb u.a. die Google Analytics Daten der wetter-arbon Seite ausgewertet und unser Konzept danach ausgerichtet.</p>
<h2 id="probleme-herausforderungen">Probleme / Herausforderungen</h2>
<p>Der Testserver läuft noch nicht. Das Problem ist das intepretieren des PHP-codes. Für die Weiterarbeit ist dies jedoch kein Kriterium im Moment und es wird versucht auch diese Herausforderung zu meistern.</p>
<h2 id="journal-zeitaufwand">Journal / Zeitaufwand</h2>
<p>2h Server aufsetzen<br />
10h DB-Archivierung Konzept<br />
2h DB vs. Textfile<br />
3.5h Ausbau Pegelsensor<br />
4.5h Mobile First<br />
1h Wochenreport   </p></div>
        </div>

        <footer class="col-md-12">
            <hr>
            <p>Documentation built with <a href="http://www.mkdocs.org/">MkDocs</a>.</p>
        </footer>
        <script>var base_url = '..';</script>
        <script src="../js/base.js"></script>
        <script src="../search/require.js"></script>
        <script src="../search/search.js"></script>

        <div class="modal" id="mkdocs_search_modal" tabindex="-1" role="dialog" aria-labelledby="Search Modal" aria-hidden="true">
    <div class="modal-dialog">
        <div class="modal-content">
            <div class="modal-header">
                <button type="button" class="close" data-dismiss="modal"><span aria-hidden="true">&times;</span><span class="sr-only">Close</span></button>
                <h4 class="modal-title" id="exampleModalLabel">Search</h4>
            </div>
            <div class="modal-body">
                <p>
                    From here you can search these documents. Enter
                    your search terms below.
                </p>
                <form role="form">
                    <div class="form-group">
                        <input type="text" class="form-control" placeholder="Search..." id="mkdocs-search-query">
                    </div>
                </form>
                <div id="mkdocs-search-results"></div>
            </div>
            <div class="modal-footer">
            </div>
        </div>
    </div>
</div><div class="modal" id="mkdocs_keyboard_modal" tabindex="-1" role="dialog" aria-labelledby="Keyboard Shortcuts Modal" aria-hidden="true">
    <div class="modal-dialog">
        <div class="modal-content">
            <div class="modal-header">
                <button type="button" class="close" data-dismiss="modal"><span aria-hidden="true">&times;</span><span class="sr-only">Close</span></button>
                <h4 class="modal-title" id="exampleModalLabel">Keyboard Shortcuts</h4>
            </div>
            <div class="modal-body">
              <table class="table">
                <thead>
                  <tr>
                    <th style="width: 20%;">Keys</th>
                    <th>Action</th>
                  </tr>
                </thead>
                <tbody>
                  <tr>
                    <td><kbd>?</kbd></td>
                    <td>Open this help</td>
                  </tr>
                  <tr>
                    <td><kbd>&larr;</kbd></td>
                    <td>Previous page</td>
                  </tr>
                  <tr>
                    <td><kbd>&rarr;</kbd></td>
                    <td>Next page</td>
                  </tr>
                  <tr>
                    <td><kbd>s</kbd></td>
                    <td>Search</td>
                  </tr>
                </tbody>
              </table>
            </div>
            <div class="modal-footer">
            </div>
        </div>
    </div>
</div>


    </body>
</html>
